<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fragmentation statistics • Makurhini</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fragmentation statistics">
<meta property="og:description" content="Makurhini">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Makurhini</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Fragmentation_statistics.html">Fragmentation statistics</a>
    </li>
    <li>
      <a href="../articles/ProtConnIndicator.html">Protected Connected indicator</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/connectscape/Makurhini/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Fragmentation_statistics_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fragmentation statistics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/connectscape/Makurhini/blob/master/vignettes/Fragmentation_statistics.Rmd"><code>vignettes/Fragmentation_statistics.Rmd</code></a></small>
      <div class="hidden name"><code>Fragmentation_statistics.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/connectscape/Makurhini">Makurhini</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></pre></div>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>We explored the <strong> MK_Fragmentation() </strong> to estimate fragmentation statistics at the landscape and patch level.</p>
</div>
<div id="example-database" class="section level2">
<h2 class="hasAnchor">
<a href="#example-database" class="anchor"></a>Example database</h2>
<p>We loaded the “vegetation_patches” database with 142 patches of old-growth vegetation from the state of Chiapas, Mexico. The shapefile has 142 rows (patches), the first column corresponds to the id of the patch.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"vegetation_patches"</span>, package <span class="op">=</span> <span class="st">"Makurhini"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">nrow</a></span><span class="op">(</span><span class="va">vegetation_patches</span><span class="op">)</span> <span class="co"># Number of patches</span>
<span class="co">#&gt; [1] 142</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">vegetation_patches</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#00B050"</span><span class="op">)</span></pre></div>
<p><img src="Fragmentation_statistics_files/figure-html/polygons-1.png" width="700"></p>
</div>
<div id="mk_fragmentation" class="section level2">
<h2 class="hasAnchor">
<a href="#mk_fragmentation" class="anchor"></a>MK_Fragmentation()</h2>
<p>To define the edge of the patches we will use a distance of 500 m from the limit of the patches (Haddad et al. 2015).</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">Fragmentation_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MK_Fragmentation.html">MK_Fragmentation</a></span><span class="op">(</span>patches <span class="op">=</span> <span class="va">vegetation_patches</span>, edge_distance <span class="op">=</span> <span class="fl">500</span>, plot <span class="op">=</span> <span class="cn">F</span>, min_patch_area <span class="op">=</span> <span class="fl">100</span>, landscape_area <span class="op">=</span> <span class="cn">NULL</span>, area_unit <span class="op">=</span> <span class="st">"km2"</span>, perimeter_unit <span class="op">=</span> <span class="st">"km"</span><span class="op">)</span></pre></div>
<div id="exploring-results" class="section level3">
<h3 class="hasAnchor">
<a href="#exploring-results" class="anchor"></a>Exploring results</h3>
<ul>
<li>The results are presented as a list, the first result is called <em>“Summary landscape metrics (Viewer Panel)”</em> and it has fragmentation statistics at landscape level.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">Fragmentation_test</span><span class="op">)</span>
<span class="co">#&gt; [1] "Summary landscape metrics (Viewer Panel)"</span>
<span class="co">#&gt; [2] "Patch statistics shapefile"</span>
<span class="va">Fragmentation_test</span><span class="op">$</span><span class="va">`Summary landscape metrics (Viewer Panel)`</span></pre></div>
<table class="table table table-condensed">
<thead><tr>
<th style="text-align:left;">
Metric
</th>
<th style="text-align:center;">
Value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Patch area (km2)
</td>
<td style="text-align:center;">
12792.2046
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of patches
</td>
<td style="text-align:center;">
142.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
Size (mean)
</td>
<td style="text-align:center;">
90.0859
</td>
</tr>
<tr>
<td style="text-align:left;">
Patches &lt; minimum patch area
</td>
<td style="text-align:center;">
126.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
Patches &lt; minimum patch area (%)
</td>
<td style="text-align:center;">
30.8017
</td>
</tr>
<tr>
<td style="text-align:left;">
Total edge
</td>
<td style="text-align:center;">
12297.5330
</td>
</tr>
<tr>
<td style="text-align:left;">
Edge density
</td>
<td style="text-align:center;">
0.9613
</td>
</tr>
<tr>
<td style="text-align:left;">
Total Core Area (km2)
</td>
<td style="text-align:center;">
7622.3940
</td>
</tr>
<tr>
<td style="text-align:left;">
Cority
</td>
<td style="text-align:center;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
Shape Index (mean)
</td>
<td style="text-align:center;">
138.4898
</td>
</tr>
<tr>
<td style="text-align:left;">
FRAC (mean)
</td>
<td style="text-align:center;">
1.4680
</td>
</tr>
<tr>
<td style="text-align:left;">
MESH (km2)
</td>
<td style="text-align:center;">
1543.1460
</td>
</tr>
</tbody>
</table>
<ul>
<li>The second output <em>“Patch statistics shapefile”</em> is a shapefile with patch level fragmentation statistics that can be saved using write_sf() from <em>‘sf’</em> package (<a href="https://cran.r-project.org/web/packages/sf/index.html" class="uri">https://cran.r-project.org/web/packages/sf/index.html</a>).</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">Fragmentation_test</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 6 features and 9 fields</span>
<span class="co">#&gt; Geometry type: POLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: 3542152 ymin: 498183.1 xmax: 3711426 ymax: 696540.5</span>
<span class="co">#&gt; CRS:           +proj=lcc +lat_1=17.5 +lat_2=29.5 +lat_0=12 +lon_0=-102 +x_0=2500000 +y_0=0 +datum=WGS84 +units=m +no_defs</span>
<span class="co">#&gt;   id      Area        CA CAPercent Perimeter EdgePercent   PARA ShapeIndex</span>
<span class="co">#&gt; 1  1 4195.5691 3541.3806   84.4076  1412.046     15.5924 2.9713  8212.7666</span>
<span class="co">#&gt; 2  2   60.2227   11.9415   19.8289   167.982     80.1711 0.3585   117.0545</span>
<span class="co">#&gt; 3  3   48.8665    6.2099   12.7079   127.049     87.2921 0.3846    79.7484</span>
<span class="co">#&gt; 4  4   15.1875    7.4210   48.8626    18.536     51.1374 0.8194     6.4864</span>
<span class="co">#&gt; 5  5   33.2716   13.0877   39.3360    55.038     60.6640 0.6045    28.5066</span>
<span class="co">#&gt; 6  6   53.1344   11.3564   21.3730   111.123     78.6270 0.4782    72.7339</span>
<span class="co">#&gt;     FRAC                       geometry</span>
<span class="co">#&gt; 1 1.4065 POLYGON ((3676911 589967.3,...</span>
<span class="co">#&gt; 2 1.8241 POLYGON ((3558044 696202.5,...</span>
<span class="co">#&gt; 3 1.7785 POLYGON ((3569169 687776.4,...</span>
<span class="co">#&gt; 4 1.1273 POLYGON ((3547317 685713.2,...</span>
<span class="co">#&gt; 5 1.4961 POLYGON ((3567471 684357.4,...</span>
<span class="co">#&gt; 6 1.6735 POLYGON ((3590569 672451.7,...</span></pre></div>
<ul>
<li>To save the shapefile you can use the ‘write_sf()’ function from ‘sf’ package: write_sf(Fragmentacion_test[[2]], “…/folder/fragmentacion.shp”)</li>
</ul>
</div>
<div id="viewing-the-results" class="section level3">
<h3 class="hasAnchor">
<a href="#viewing-the-results" class="anchor"></a>Viewing the results</h3>
<p>We can visualize the static at the patch level using the default <em>plot()</em> function or other spatial information display packages like the <em>‘tmap’</em> package, for example:</p>
<ul>
<li>Core area (%):</li>
</ul>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<ul>
<li>Edge (%)</li>
</ul>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<ul>
<li>Perimeter-area ratio (PARA)</li>
</ul>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<ul>
<li>Shape Index</li>
</ul>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<ul>
<li>Fractal Dimension Index</li>
</ul>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div id="exploring-other-edge-depths" class="section level3">
<h3 class="hasAnchor">
<a href="#exploring-other-edge-depths" class="anchor"></a>Exploring other edge depths</h3>
<p>We can make a loop where we explore different edge depths. In the following example, We will explore 10 edge depths (<em>edge_distance argument</em>): 100, 200, 300, 400, 500, 600, 700, 800, 900 and 1000 meters. We will apply the <em>‘MK_Fragmentation’</em> function using the previous distances and then, we will extract the core area percentage and edge percentage statistics. Finally, we will plot the average of the patch core area percentage and edge percentage (% core area + % edge = 100%).</p>
<pre><code>#&gt;   Edge.distance      Type Percentage
#&gt; 1           100 Core Area   83.50499
#&gt; 2           100      Edge   16.49501
#&gt; 3           200 Core Area   68.18516
#&gt; 4           200      Edge   31.81484
#&gt; 5           300 Core Area   54.77231
#&gt; 6           300      Edge   45.22769</code></pre>
<p><img src="Fragmentation_statistics_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>The average core area percentage (average patch area that has the least possible edge effect) for all patches decreases by more than 70% when considering an edge effect with an edge depth distance of 1 km.</p>
<table class="table">
<thead><tr class="header">
<th>Edge depth distance (m)</th>
<th align="center">CoreArea (%)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>100</td>
<td align="center">83.5%</td>
</tr>
<tr class="even">
<td>500</td>
<td align="center">34.14%</td>
</tr>
<tr class="odd">
<td>1000</td>
<td align="center">9.78%</td>
</tr>
</tbody>
</table>
<p><strong>Reference</strong>:</p>
<ul>
<li><p>INEGI. (2013). Conjunto de datos vectoriales de uso del suelo y vegetación, serie V (capa unión), escala 1:250,000. Instituto Nacional de Estadística y Geografía, Aguascalientes.</p></li>
<li><p>McGarigal, K., S. A. Cushman, M. C. Neel, and E. Ene. 2002. FRAGSTATS: Spatial Pattern Analysis Program for Categorical Maps. Computer software program produced by the authors at the University of Massachusetts, Amherst. Available at the following web site: www.umass.edu/landeco/research/fragstats/fragstats.html.</p></li>
<li><p>Haddad et al. (2015). Science Advances 1(2):e1500052. DOI: 10.1126/sciadv.1500052.</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Oscar Godínez-Gómez, Camilo A. Correa Ayram.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
